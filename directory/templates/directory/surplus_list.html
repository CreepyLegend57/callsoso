{% extends "website/base.html" %}
{% load static %}

{% block title %}Surplus Listings{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/surplus.css' %}">

<div class="surplus-container mt-4">

    <header class="page-header mb-4 text-center">
        <h2>üì¶ My Surplus Listings</h2>
        <p class="intro-text">Manage your materials and share them with our creative ecosystem.</p>
        <a href="{% url 'surplus_create' %}" class="btn btn-primary mt-2">‚ûï Add New Surplus</a>
    </header>

    <!-- SEARCH & FILTERS -->
    <section class="search-filters mb-4">
        <form method="GET" class="d-flex flex-wrap gap-2 justify-content-center">
            <input type="text" name="q" class="form-control" placeholder="Search materials..." value="{{ request.GET.q|default:'' }}">

            <select name="material_type" class="form-select">
                <option value="">All Types</option>
                <option value="wood" {% if request.GET.material_type == 'wood' %}selected{% endif %}>Wood</option>
                <option value="metal" {% if request.GET.material_type == 'metal' %}selected{% endif %}>Metal</option>
                <option value="textiles" {% if request.GET.material_type == 'textiles' %}selected{% endif %}>Textiles</option>
            </select>

            <select name="location" class="form-select">
                <option value="">All Locations</option>
                <option value="Milton Keynes" {% if request.GET.location == 'Milton Keynes' %}selected{% endif %}>Milton Keynes</option>
                <option value="London" {% if request.GET.location == 'London' %}selected{% endif %}>London</option>
            </select>

            <button type="submit" class="btn btn-secondary">üîç Search</button>
        </form>
    </section>

    {% if listings %}
        <ul class="surplus-list list-group">
            {% for surplus in listings %}
                <li class="list-group-item shadow-sm">
                    <strong>{{ surplus.company }}</strong><br>
                    Material: {{ surplus.material_type }}<br>
                    Volume: {{ surplus.monthly_volume }} units<br>
                    Location: {{ surplus.location }}
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <div class="alert alert-warning mt-3 text-center">
            No surplus listings found.
        </div>
    {% endif %}

    <div class="mt-3 text-center">
        <a href="{% url 'directory_home' %}" class="btn btn-link">‚Üê Back to Directory Home</a>
    </div>
</div>
{% endblock %}
